---
title: å¥‡å¼‚å€¼åˆ†è§£çš„åŸç†ä¸ä½¿ç”¨
tags:
  - DeepLearning
  - SVD
  - singular value decomposition
categories:
  - AI
  - Machine Learning
toc: true
thumbnail: "https://imgs.borgor.cn/imgs/20190920155358.png"
abbrlink: 592f7ae4
date: 2019-09-20 08:29:53
---

# å¥‡å¼‚å€¼åˆ†è§£çš„åŸç†

## ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡

ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„å®šä¹‰å¦‚ä¸‹ï¼š

$$
Ax = \lambda x
\tag{1}
$$

å…¶ä¸­ï¼Œ$\lambda$æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œ$x$æ˜¯ä¸€ä¸ªå‘é‡ï¼Œ$\lambda$ç§°ä½œçŸ©é˜µ$A$çš„ç‰¹å¾å€¼ï¼Œ$x$æ˜¯å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚

æ±‚å¾—æ‰€æœ‰ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹çŸ©é˜µ A è¿›è¡Œç‰¹å¾åˆ†è§£ã€‚å…·ä½“å¦‚ä¸‹ï¼š

$$
A = W \Sigma W^{-1}
\tag{2}
$$

å…¶ä¸­ï¼Œ$W$æ˜¯ç”±$A$çš„æ‰€æœ‰ç‰¹å¾å‘é‡ç»„æˆçš„$n\times n$ç»´çŸ©é˜µã€‚$\Sigma$æ˜¯ä»¥$A$çš„æ‰€æœ‰ç‰¹å¾å€¼$\lambda_1,\lambda_2,\dots, \lambda_n$ä¸ºå¯¹è§’çº¿çš„å¯¹è§’çŸ©é˜µã€‚æˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠ$W$çš„è¿™$n$ä¸ªç‰¹å¾å‘é‡æ ‡å‡†åŒ–ï¼Œå³æ»¡è¶³$||w_i|| = 1$æˆ–è€…$w_i^T \cdot w_i = w_i^T w_i=1$ï¼Œæ­¤æ—¶ï¼Œ$W$çš„$n$ä¸ªå‘é‡ä¸ºæ ‡å‡†æ­£äº¤åŸºã€‚

æ•…ï¼š

$$
W^{-1} = W^T
\tag{3}
$$

è¿™æ ·æˆ‘ä»¬çš„ç‰¹å¾åˆ†è§£è¡¨è¾¾å¼å¯ä»¥å†™æˆ

$$
A = W \Sigma W^T
\tag{4}
$$

<!-- more -->

## $SVD$çš„å®šä¹‰

$SVD$ä¹Ÿæ˜¯å¯¹çŸ©é˜µè¿›è¡Œåˆ†è§£ï¼Œä½†æ˜¯å’Œç‰¹å¾åˆ†è§£ä¸åŒï¼Œ$SVD$å¹¶ä¸è¦æ±‚è¦åˆ†è§£çš„çŸ©é˜µä¸ºæ–¹é˜µã€‚å‡è®¾æˆ‘ä»¬çš„çŸ©é˜µ A æ˜¯ä¸€ä¸ª$ğ‘šÃ—ğ‘›$çš„çŸ©é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰çŸ©é˜µ$A$çš„$SVD$ä¸ºï¼š

$$
A = U\Sigma V^T
\tag{5}
$$

å…¶ä¸­ï¼Œ$U$çš„å½¢çŠ¶ä¸ºï¼š$m \times m$ï¼Œ$\Sigma$çš„å½¢çŠ¶ä¸º$m \times n$ï¼Œæ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šçš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯$A$çš„ä¸€ä¸ª**å¥‡å¼‚å€¼**ï¼Œ$V$çš„å½¢çŠ¶ä¸º$n \times n$ï¼Œ$A$çš„å½¢çŠ¶ä¸$\Sigma$çš„å½¢çŠ¶ä¸€è‡´ã€‚åœ¨æ­¤å¤„ï¼Œ$U$å’Œ$V^T$éƒ½æ˜¯é…‰çŸ©é˜µï¼Œå³ï¼š

$$
U^TU=I \\\\ V^TV=I
\tag{6}
$$

## $SVD$çš„æ±‚æ³•

$$
\begin{align}
A & = U\Sigma V^T  \\\\
\Rightarrow AV & = U\Sigma V^TV \\\\
\Rightarrow AV & =U\Sigma  \\\\
\Rightarrow  Av_i & = \sigma_i u_i \\\\
\Rightarrow  \sigma_i & =  Av_i / u_i
\end{align}
\tag{7}
$$

è¿™æ ·æˆ‘ä»¬å¯ä»¥æ±‚å‡ºæˆ‘ä»¬çš„æ¯ä¸ªå¥‡å¼‚å€¼ï¼Œè¿›è€Œæ±‚å‡ºå¥‡å¼‚å€¼çŸ©é˜µ$\Sigma$ã€‚æˆ‘ä»¬è¯´$A^TA$çš„**ç‰¹å¾å‘é‡**ç»„æˆçš„å°±æ˜¯æˆ‘ä»¬$SVD$ä¸­çš„$V$çŸ©é˜µï¼Œè€Œ$AA^T$çš„ç‰¹å¾å‘é‡ç»„æˆçš„å°±æ˜¯æˆ‘ä»¬$SVD$ä¸­çš„$U$çŸ©é˜µã€‚

$$
U^TU=I, \Sigma^T\Sigma=\Sigma^2
\tag{8}
$$

$$
\begin{align}
A & =U\Sigma V^T \\\\
\Rightarrow A^T & = V\Sigma^T U^T \\\\
\Rightarrow A^TA & = V\Sigma^T U^TU\Sigma V^T \\\\
&= V\Sigma^2V^T
\end{align}
\tag{9}
$$

å¯ä»¥çœ‹å‡º$A^T A$çš„ç‰¹å¾å‘é‡ç»„æˆçš„çš„ç¡®å°±æ˜¯æˆ‘ä»¬$SVD$ä¸­çš„ V çŸ©é˜µã€‚ç±»ä¼¼çš„æ–¹æ³•å¯ä»¥å¾—åˆ°$AA^T$çš„ç‰¹å¾å‘é‡ç»„æˆçš„å°±æ˜¯æˆ‘ä»¬$SVD$ä¸­çš„$U$çŸ©é˜µã€‚

è¿›ä¸€æ­¥æˆ‘ä»¬è¿˜å¯ä»¥çœ‹å‡ºæˆ‘ä»¬çš„ç‰¹å¾å€¼çŸ©é˜µç­‰äºå¥‡å¼‚å€¼çŸ©é˜µçš„å¹³æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ç‰¹å¾å€¼å’Œå¥‡å¼‚å€¼æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼š

$$
\sigma_i = \sqrt{\lambda_i}
\tag{10}
$$

è¿™æ ·ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨$\sigma_i =  \frac{Av_i}{u_i}$æ¥è®¡ç®—å¥‡å¼‚å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ±‚å‡º$A^T A$çš„ç‰¹å¾å€¼å–å¹³æ–¹æ ¹æ¥æ±‚å¥‡å¼‚å€¼ã€‚

## $SVD$çš„ä½¿ç”¨

$SVD$çš„ä½¿ç”¨ä¸»è¦æ˜¯ç”¨åœ¨ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ–¹é¢æ˜¯ä¸»æˆåˆ†åˆ†æã€‚

### ä¸»æˆåˆ†åˆ†æ

$$
A_{m \times n} = U_{m \times m}\Sigma_{m \times n} V^T_{n \times n} \approx U_{m \times k}\Sigma_{k \times k} V^T_{k \times n}
\tag{11}
$$

ä¸Šå¼çš„ä¸»è¦æ„ä¹‰åœ¨äºï¼Œä½¿ç”¨å¥‡å¼‚å€¼å»è¿‘ä¼¼çš„è¡¨è¾¾ä¸€ä¸ªçŸ©é˜µï¼Œå› ä¸º$\Sigma$ä¸­çš„å¥‡å¼‚å€¼æ˜¯æ ¹æ®å¤§å°æ’åˆ—çš„ï¼Œå¦‚æœèˆå»è¾ƒå°çš„å¥‡å¼‚å€¼ï¼Œåœ¨å°†åªä¹˜å›å»ï¼Œå¾—åˆ°çš„ç»“æœä¸åŸçŸ©é˜µååˆ†è¿‘ä¼¼ã€‚è¾ƒå¤§çš„å¥‡å¼‚å€¼ç»„åˆå°±å˜æˆäº†åŸçŸ©é˜µçš„ä¸»è¦æˆåˆ†ã€‚

### é™ç»´

ä¹Ÿæ˜¯æ ¹æ®$(11)$å¼ï¼Œæˆ‘ä»¬å°†è¾ƒå°çš„ä¸€éƒ¨åˆ†å¥‡å¼‚å€¼èˆå»çš„è¯ï¼Œåœ¨è¿›è¡ŒçŸ©é˜µè¿ç®—çš„æ—¶å€™å¯ä»¥è¾¾åˆ°é™ç»´çš„ä½œç”¨ã€‚

# $SVD$åœ¨å›¾åƒå¤„ç†ä¸­çš„åº”ç”¨ã€‚

## å…ˆä¸Šä»£ç 

```python
from PIL import Image
import numpy as np
from numpy import linalg as la


def processImg(img, gate):
    a = np.asarray(img)
    u, sigma, vt = la.svd(a)
    s = np.zeros([u.shape[0], vt.shape[1]])
    c = 0
    gate = (gate / 100) * (u.shape[0] if u.shape[0] < vt.shape[1] else vt.shape[1])
    for i in sigma:
        s[c][c] = i if c < gate else 0
        c = c + 1
    return Image.fromarray(np.dot(np.dot(u, s), vt)).convert('L')


if __name__ == '__main__':
    for image in range(8):
        img = Image.open("source_img/img.%s.jpg" % image)
        r, g, b = img.split()
        for i in [1, 5, 10, 25, 50, 70, 90]:
            print("processing ã€image%sã€‘  %s%s ..." % (image, i, '%'))
            nr = processImg(r, i)
            ng = processImg(g, i)
            nb = processImg(b, i)
            img = Image.merge('RGB', [nr, ng, nb])
            img.save('imgs/img.%s.%s.png' % (image, i), "png")
            print("\tã€image%sã€‘Done" % image)
    print("done...")
```

## å®Œæˆåçš„å›¾ç‰‡

> ä»¥ä¸‹å›¾ç‰‡å‡æ¥è‡ªç½‘ç»œï¼Œè‹¥æœ‰ä¾µæƒè¯·è”ç³»åˆ é™¤ï¼š cyrusky#borgor.cn

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.0.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.0.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.1.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.1.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.2.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.2.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.3.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.3.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.4.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.4.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.5.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.5.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.6.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.6.90.png)

![åŸå›¾)](https://imgs.borgor.cn/imgs/svd/img.7.jpg)
![ä¿ç•™1%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.1.png)
![ä¿ç•™5%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.5.png)
![ä¿ç•™10%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.10.png)
![ä¿ç•™25%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.25.png)
![ä¿ç•™50%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.50.png)
![ä¿ç•™70%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.70.png)
![ä¿ç•™90%çš„å¥‡å¼‚å€¼)](https://imgs.borgor.cn/imgs/svd/img.7.90.png)

</div>

## ç»“è®º

æˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š

| ä¿ç•™å¥‡å¼‚å€¼çš„ç™¾åˆ†æ¯” | ç»“è®º                                 |
| ------------------ | ------------------------------------ |
| 1%                 | ç»†èŠ‚ç¼ºå¤±ï¼Œæ— æ³•è§‚å¯Ÿå…·ä½“å›¾åƒ           |
| 5%                 | èƒ½å¤Ÿè‚‰çœ¼åˆ†è¾¨å›¾åƒå†…å®¹ï¼Œä½†æ˜¯å™ªç‚¹ç‰¹åˆ«å¤š |
| 10%                | æœ‰å°‘é‡å™ªç‚¹ï¼Œç»†èŠ‚å¯è§                 |
| >=25%              | æ— è‚‰çœ¼å¯è§å™ªç‚¹ï¼Œç»†èŠ‚æ¸…æ™°å¯è§         |

ç”±å…·ä½“å®éªŒå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œç…§ç‰‡ä¸­å«æœ‰çš„ç»†èŠ‚è¾ƒå¤šï¼Œæ‰€ä»¥ï¼Œåœ¨ä¿ç•™ç›¸åŒç™¾åˆ†æ¯”çš„å¥‡å¼‚å€¼çš„æƒ…å†µä¸‹ï¼Œè¾ƒæ¼«ç”»ã€å¡é€šã€æ‰‹ç»˜ç­‰å›¾ç‰‡çš„å¤±çœŸç‡é«˜ã€‚
