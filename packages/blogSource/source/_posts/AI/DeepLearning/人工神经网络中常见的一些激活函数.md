---
title: äººå·¥ç¥ç»ç½‘ç»œä¸­å¸¸è§çš„ä¸€äº›æ¿€æ´»å‡½æ•°
tags:
  - æ·±åº¦å­¦ä¹ 
categories:
  - AI
  - DeepLearning
toc: true
abbrlink: b8ed4627
date: 2020-04-16T11:41:14.000Z
cover: /assets/images/20200416175942.webp
thumbnail: /assets/thumbnail/20200416175942.webp
---

# æ¿€æ´»å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ

## ç¥ç»å…ƒ

äººå·¥ç¥ç»å…ƒï¼ˆ*Artificial Neuron*ï¼‰ï¼Œç®€ç§°ç¥ç»å…ƒï¼ˆ*Neuron*ï¼‰ï¼Œæ˜¯æ„æˆç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒï¼Œå…¶ä¸»è¦æ˜¯æ¨¡æ‹Ÿç”Ÿç‰©ç¥ç»å…ƒçš„ç»“æ„å’Œç‰¹æ€§ï¼Œæ¥æ”¶ä¸€ç»„è¾“å…¥ä¿¡å·å¹¶äº§ç”Ÿè¾“å‡ºã€‚

<!-- more -->

åœ¨ AI é¢†åŸŸï¼Œä¸€ä¸ªç¥ç»å…ƒçš„è¾“å…¥è¾“å‡ºæ˜¯è¿™æ ·çš„ï¼Œæ¥æ”¶$D$ä¸ªè¾“å…¥$\lbrace x_1, x_2, \cdots, x_D
\rbrace$ï¼Œä»¤å‘é‡$ğ’™ =  [ x_1, x_2, \cdots, x_D]$æ¥ è¡¨ç¤ºè¿™ç»„è¾“å…¥ï¼Œå¹¶ç”¨å‡€è¾“å…¥(_Net Input_) $ğ‘§ âˆˆ â„$ è¡¨ç¤ºä¸€ä¸ªç¥ç»å…ƒæ‰€è·å¾—çš„è¾“å…¥ä¿¡å·$ğ’™$çš„åŠ æƒå’Œï¼š

$$
\begin{align}
z & = \sum_{d=1}^D \omega_d x_d + b \\\\
& = \omega^T x + b \tag{1}
\end{align}
$$

å…¶ä¸­ï¼š$ğ’˜ = [ğ‘¤_1, ğ‘¤_2, â‹¯ , ğ‘¤_ğ·] âˆˆ â„^D$.

## æ¿€æ´»å‡½æ•°

ç„¶åè®©ä¸Šè¿°çš„$z$ç»è¿‡æ¿€æ´»å‡½æ•°ï¼Œå°±å¾—åˆ°äº†æˆ‘ä»¬çš„$\alpha$ï¼Œå…·ä½“å¦‚å›¾ï¼š

![äººå·¥ç¥ç»å…ƒ](/assets/images/image-20200416143736956.webp)

æ‰€ä»¥ï¼Œæ¿€æ´»å‡½æ•°å…¶å®æ˜¯å¯¹ç¥ç»å…ƒçš„å¤„ç†ç»“æœçš„ä¸€ä¸ªä¿®é¥°ï¼Œè®©å…¶è§„èŒƒåŒ–ï¼Œå¹¶ä¸”é€‚åº”æ¨¡å‹ã€‚

ä»€ä¹ˆæ ·çš„å‡½æ•°å¯ä»¥ä½œä¸ºæ¿€æ´»å‡½æ•°å‘¢ï¼Ÿéœ€è¦æ»¡è¶³è¿™ä¹ˆå‡ ä¸ªæ¡ä»¶ï¼š

1. è¿ç»­å¹¶å¯å¯¼ï¼ˆå…è®¸å°‘æ•°ç‚¹ä¸Šä¸å¯å¯¼ï¼‰çš„éçº¿æ€§å‡½æ•°ï¼å¯å¯¼çš„æ¿€æ´»å‡½æ•°å¯ä»¥ç›´æ¥åˆ©ç”¨æ•°å€¼ä¼˜åŒ–çš„æ–¹æ³•æ¥å­¦ä¹ ç½‘ç»œå‚æ•°ï¼
2. æ¿€æ´»å‡½æ•°åŠå…¶å¯¼å‡½æ•°è¦å°½å¯èƒ½çš„ç®€å•ï¼Œæœ‰åˆ©äºæé«˜ç½‘ç»œè®¡ç®—æ•ˆç‡ï¼
3. æ¿€æ´»å‡½æ•°çš„å¯¼å‡½æ•°çš„å€¼åŸŸè¦åœ¨ä¸€ä¸ªåˆé€‚çš„åŒºé—´å†…ï¼Œä¸èƒ½å¤ªå¤§ä¹Ÿä¸èƒ½å¤ªå°ï¼Œå¦åˆ™ä¼šå½±å“è®­ç»ƒçš„æ•ˆç‡å’Œç¨³å®šæ€§ï¼

# å¸¸è§çš„æ¿€æ´»å‡½æ•°

## å‡½æ•°çš„é¥±å’Œæ€§

> å¯¹äºå‡½æ•° $ğ‘“(ğ‘¥)$:
>
> 1. è‹¥ $ğ‘¥ \rightarrow âˆ’\infty$ æ—¶ï¼Œå…¶å¯¼æ•° $ğ‘“ â€² (ğ‘¥) \rightarrow 0$ï¼Œåˆ™ç§°å…¶ä¸ºå·¦é¥±å’Œï¼›
> 2. è‹¥ $ğ‘¥ \rightarrow +\infty$ æ—¶ï¼Œå…¶å¯¼æ•° $ğ‘“ â€² (ğ‘¥) \rightarrow 0$ï¼Œåˆ™ç§°å…¶ä¸ºå³é¥±å’Œï¼›
> 3. å½“åŒæ—¶æ»¡è¶³å·¦ã€å³é¥±å’Œæ—¶ï¼Œå°±ç§°ä¸ºä¸¤ç«¯é¥±å’Œï¼

## æ¿€æ´»å‡½æ•°çš„å…¨å®¶ç¦

![æ¿€æ´»å‡½æ•°çš„å…¨å®¶ç¦](/assets/images/image-20200416150043935.webp)

è™½è¯´æ˜¯å…¨å®¶ç¦ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å°† Swish å‡½æ•°ã€GeLU å‡½æ•°ã€MaxOut å‡½æ•°åŠ åˆ°é‡Œé¢ï¼Œå¦‚æœåŠ åˆ°é‡Œé¢çš„è¯ï¼Œå›¾å°±å¤ªå¤æ‚äº†ï¼Œæ²¡æ³•çœ‹äº†ï¼Œä¸‹é¢ä¼šæœ‰å•ç‹¬çš„é“ç…§ã€‚

> By the way, é˜¶è·ƒå‡½æ•°ä¸­é—´é‚£ç‚¹çœ‹ç€æ˜¯ä¸æ˜¯å¥½åƒæ˜¯æ­ªçš„ï¼Ÿ æ²¡é”™ï¼Œå°±æ˜¯æ­ªçš„ï¼ˆä½†æ˜¯å®é™…å‡½æ•°æ˜¯ç›´çš„å“ˆï¼Œä¸è¦æé”™äº†ï¼‰ï¼Œæˆ‘å– X çš„ç¦»æ•£ç‚¹çš„æ—¶å€™ï¼Œæ²¡æœ‰å§
> 0 å–åˆ°é‡Œé¢ï¼Œæ‰€ä»¥ç›´æ¥å°±ä»$f(0_-)$åˆ°äº†$f(0_+)$ï¼Œæœ‰ä¸€ä¸ªå¾ˆå°å¾ˆå°çš„åå·®ï¼Œä¸è¦åœ¨æ„è¿™äº›ç»†èŠ‚ã€‚

## é˜¶è·ƒå‡½æ•°ï¼ˆHeaviside å‡½æ•°ï¼‰

$$
Heaviside(x) = \left \lbrace \begin{align} 1,& \qquad x \ge 0 \\\\ 0,& \qquad x < 0 \end{align} \right . \tag{2}
$$

ç®€å•ç²—æš´ï¼Œç»™äººçš„æ„Ÿè§‰å¾ˆå®¹æ˜“è®¡ç®—ï¼Œå…¶å®å‘¢ï¼Œç»™è®¡ç®—æœºä¹Ÿå¾ˆå®¹æ˜“è®¡ç®—ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬çš„æœºå™¨å­¦ä¹ ï¼Œå°¤å…¶æ˜¯æ·±åº¦å­¦ä¹ ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯åœ¨æ±‚è§£ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜ï¼Œåœ¨è¿™æ ·çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å†å»çœ‹é˜¶è·ƒå‡½æ•°ï¼Œå°±ä¼šå‘ç°ï¼Œè¿™ä¸ªå‡½æ•°è™½ç„¶å¾ˆå¥½ç®—ï¼Œä½†æ˜¯ä¸å¯å¾®ï¼Œæ²¡æ³•æ±‚å¯¼åœ¨å‡¸ä¼˜åŒ–ä¸­å°±ä¸å¥½è®¡ç®—æœ€ä¼˜äº†ã€‚

![é˜¶è·ƒå‡½æ•°](/assets/images/image-20200416151321993.webp)

```python
X = np.linspace(-2.5,2.5,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_heaviside = np.array([1 if x >= 0 else 0 for x in X])

plt.figure(figsize=(20,10))
plt.hlines(0, -2.5, 2.5, colors = "gray", linestyles = "dashed")
plt.vlines(0, -2.5, 2.5, colors = "gray", linestyles = "dashed")
plt.plot(X, y_heaviside,label="Heaviside", color='darkred')
plt.legend(loc='best')
```

## Logestic å‡½æ•°

> Logestic å‡½æ•°å’Œ tanh å‡½æ•°éƒ½æ˜¯ Sigmoid å‹å‡½æ•°ï¼ŒSigmoid çš„æœ¬æ„ä¹Ÿå°±æ˜¯`Så‹`çš„æ„æ€ï¼Œå¦‚æœçœ‹ä»–ä»¬çš„å›¾åƒï¼Œä½ å¾ˆå®¹æ˜“å°±æ˜ç™½äº†ã€‚

$$
Logestic(x) = \frac{1}{1+e^{-x}} \tag{3.1}
$$

`Logistic` å‡½æ•°å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªâ€œæŒ¤å‹â€å‡½æ•°ï¼ŒæŠŠä¸€ä¸ªå®æ•°åŸŸçš„è¾“å…¥â€œæŒ¤å‹â€åˆ°$ (0, 1)$ï¼å½“è¾“å…¥å€¼åœ¨ $0$ é™„è¿‘æ—¶ï¼Œ$Sigmoid$
å‹å‡½æ•°è¿‘ä¼¼ä¸ºçº¿æ€§å‡½æ•°ï¼›å½“è¾“å…¥å€¼é è¿‘ä¸¤ç«¯æ—¶ï¼Œå¯¹è¾“å…¥è¿›è¡ŒæŠ‘åˆ¶ï¼è¾“å…¥è¶Šå°ï¼Œè¶Šæ¥è¿‘äº $0$ ï¼›è¾“å…¥è¶Šå¤§ï¼Œè¶Šæ¥è¿‘äº
$1$ï¼è¿™æ ·çš„ç‰¹ç‚¹ä¹Ÿå’Œç”Ÿç‰©ç¥ç»å…ƒç±»ä¼¼ï¼Œå¯¹ä¸€äº›è¾“å…¥ä¼šäº§ç”Ÿå…´å¥‹ï¼ˆè¾“å‡ºä¸º $1$ ï¼‰ï¼Œå¯¹å¦ä¸€äº›è¾“å…¥äº§ç”ŸæŠ‘åˆ¶ï¼ˆè¾“å‡ºä¸º $0$
ï¼‰ï¼å’Œæ„ŸçŸ¥å™¨ä½¿ç”¨çš„é˜¶è·ƒæ¿€æ´»å‡½æ•°ç›¸æ¯”ï¼Œ`Logistic` å‡½æ•°æ˜¯è¿ç»­å¯å¯¼çš„ï¼Œå…¶æ•°å­¦æ€§è´¨æ›´å¥½ï¼ˆç›¸æ¯”é˜¶è·ƒå‡½æ•°æ¥è¯´ï¼‰ï¼

å› ä¸º `Logistic`å‡½æ•°çš„æ€§è´¨ï¼Œä½¿å¾—è£…å¤‡äº† `Logistic` æ¿€æ´»å‡½æ•°çš„ç¥ç»å…ƒå…·æœ‰ä»¥ä¸‹ä¸¤ç‚¹æ€§è´¨:

1. å…¶è¾“å‡ºç›´æ¥å¯ä»¥çœ‹ä½œæ¦‚ç‡åˆ†å¸ƒï¼Œä½¿å¾—ç¥ç»ç½‘ç»œå¯ä»¥æ›´å¥½åœ°å’Œç»Ÿè®¡å­¦ä¹ æ¨¡å‹è¿›è¡Œç»“åˆï¼
2. å…¶å¯ä»¥çœ‹ä½œä¸€ä¸ªè½¯æ€§é—¨ï¼ˆ`Soft Gate`ï¼‰ï¼Œç”¨æ¥æ§åˆ¶å…¶ä»–ç¥ç»å…ƒè¾“å‡ºä¿¡æ¯çš„æ•°é‡ï¼

### Logestic å‡½æ•°çš„ä¸€ä¸ªå¥‡ç‰¹çš„æ€§è´¨

$$
Logestic '(x) = Logestic(x) [1- Logestic(x)] \tag{3.2}
$$

æ‰€ä»¥è¯´ï¼ŒLogestic å‡½æ•°çš„å¯¼æ•°æ¯”è¾ƒå¥½è®¡ç®—ã€‚

### Hard-Logestic å‡½æ•°

è™½ç„¶è¯´ï¼ŒLogestic å‡½æ•°çš„å¯¼æ•°æ¯”è¾ƒå¥½è®¡ç®—ï¼Œä½†æ˜¯ï¼Œæ¯•ç«Ÿå…¶ä¸­è¿˜æ˜¯æœ‰ä¸€äº›æ±‚è§£$e$çš„æŒ‡æ•°å€¼çš„æ“ä½œï¼Œè¿™æ ·å¯¹äºå¾ˆå¤§çš„æ¨¡å‹æ¥è¯´ï¼Œè®¡ç®—é‡å¢åŠ çš„ä¸æ˜¯ä¸€ç‚¹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å·ä¸ªæ‡’ï¼Œ
å¯»æ‰¾ä¸€ç§ä»£æ›¿çš„è§£å†³åŠæ³•ã€‚

æ‰€è°“`Hard-Logestic`å‡½æ•°å°±æ˜¯é€šè¿‡æ³°å‹’å…¬å¼ï¼Œåœ¨$0$ç‚¹å±•å¼€ Logestic å‡½æ•°ï¼ˆå³éº¦å…‹åŠ³æ—å±•å¼€ï¼‰ï¼Œåªå–å‰ä¸¤é¡¹æˆ–è€…å‰ n é¡¹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

$$
\begin{align}
g_l(x) & â‰ˆ ğœ(x) + x \times ğœ ' (x) \\\\
& = 0.25ğ‘¥ + 0.5
\end{align} \tag{3.3}
$$

$$
\begin{aligned}
HardLogestic(x) & = \left \lbrace
\begin{align}
1 & \qquad g_l(x) \ge 1 ; \\\\
g_l & \qquad 0 \lt g_l(x) \le 1 ; \\\\
0 & \qquad g_l(x) \le 0
\end{align}
\right . \\\\
& = \max ( \min(g_l(x), 1), 0) \\\\
& = \max ( \min(0.25x + 0.5, 1), 0)
\end{aligned} \tag{3.4}
$$

è¿™æ ·ï¼Œå°±å¯ä»¥æŠŠæŒ‡æ•°è¿ç®—è½¬æ¢æˆäº†åŠ å‡ä¹˜é™¤å’Œæ¯”å¤§å°äº†ã€‚

![Logesticå‡½æ•°å’ŒHardLogesticå‡½æ•°](/assets/images/image-20200416153609759.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_hard_logestic = np.array([max(min(0.25 * x + 0.5, 1), 0) for x in X])
y_logestic = 1 / (1 + np.exp(-X))
plt.figure(figsize=(20,10))
plt.hlines(0, -2., 2.5, colors = "gray", linestyles = "dashed")
plt.vlines(0, -0.1, 1.1, colors = "gray", linestyles = "dashed")
plt.plot(X, y_logestic,label="Logestic", color='red')
plt.plot(X, y_hard_logestic, label="Hard Logestic", color='green', linestyle='dashed' )
plt.legend(loc='best')
```

## tanh å‡½æ•°

$$
tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}} \tag{4.1}
$$

`Tanh` å‡½æ•°å¯ä»¥çœ‹ä½œæ”¾å¤§å¹¶å¹³ç§»çš„ `Logistic`å‡½æ•°ï¼Œå…¶å€¼åŸŸæ˜¯$(âˆ’1, 1)$ï¼

tanh å‡½æ•°çš„è¾“å‡ºæ˜¯é›¶ä¸­å¿ƒåŒ–çš„ï¼ˆZero-Centeredï¼‰ï¼Œè€Œ Logistic å‡½æ•°çš„è¾“å‡ºæ’å¤§äº 0ï¼

éé›¶ä¸­å¿ƒåŒ–çš„è¾“å‡ºä¼šä½¿å¾—å…¶åä¸€å±‚çš„ç¥ç»å…ƒçš„è¾“å…¥å‘ç”Ÿåç½®åç§»ï¼ˆBias Shiftï¼‰ï¼Œå¹¶è¿›ä¸€æ­¥ä½¿å¾—æ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ï¼

### Hard-tanh å‡½æ•°

åŒæ ·å› ä¸ºå…¶è®¡ç®—çš„éš¾åº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³°å‹’å±•å¼€å¼ï¼ˆéº¦å…‹åŠ³æ—å±•å¼€ï¼‰æ¥è¿‘ä¼¼çš„é€¼è¿‘`tanh`å‡½æ•°ã€‚

$$
\begin{align}
g_t(x) & â‰ˆ \tanh(0) + x \times \tanh ' (0) \\\\
& = x
\end{align} \tag{4,2}
$$

$$
\begin{align}
hard\tanh(ğ‘¥) = \max ( \min(g_t(x), 1), âˆ’1) \\\\ = \max ( \min(ğ‘¥, 1), âˆ’1)
\end{align} \tag{4.3}
$$

![tanhå‡½æ•°å’ŒHard-tanhå‡½æ•°](/assets/images/image-20200416153820410.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_tanh = (np.exp(X) - np.exp(-X)) / (np.exp(X) + np.exp(-X))
y_hard_tanh = np.array([max(min(x , 1), -1) for x in X])
plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -1.1, 1.1, colors = "gray", linestyles = "dashed")
plt.plot(X, y_tanh,label="Logestic", color='red')
plt.plot(X, y_hard_tanh, label="Hard Logestic", color='green', linestyle='dashed' )
plt.legend(loc='best')
```

éé›¶ä¸­å¿ƒåŒ–çš„è¾“å‡ºä¼š ä½¿å¾—å…¶åä¸€å±‚çš„ç¥ç»å…ƒçš„è¾“å…¥å‘ç”Ÿåç½®åç§»ï¼ˆBias Shiftï¼‰ï¼Œå¹¶è¿›ä¸€æ­¥ä½¿å¾—æ¢¯åº¦ä¸‹ é™çš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ï¼

## ReLU å‡½æ•°

$ReLU$ï¼ˆ`Rectified Linear Unit`ï¼Œä¿®æ­£çº¿æ€§å•å…ƒï¼‰ï¼Œä¹Ÿå« Rectifier å‡½æ•°ï¼Œæ˜¯ç›®å‰æ·±åº¦ç¥ç»ç½‘ç»œä¸­ç»å¸¸ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ï¼ $ReLU$
å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–œå¡ï¼ˆrampï¼‰å‡½æ•°ï¼Œå®šä¹‰ä¸º:

$$
ReLU = \left \lbrace
\begin{align}
x & \qquad x \gt 0; \\\\
0 & \qquad x \le 0
\end{align}
\right .
\tag{5.1}
$$

æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå…¶å® $ReLU$ å‡½æ•°å°±æ˜¯ä¸€ä¸ªé«˜é€šæ»¤æ³¢å™¨ï¼Œä»–è¿‡æ»¤æ‰äº†æ‰€æœ‰å°äº $0$ çš„å€¼ï¼Œå¯¹äºæ‰€æœ‰å¤§äº $0$ çš„å€¼åˆ™åŸæ ·è¾“å‡ºã€‚

### ä¼˜ç‚¹

é‡‡ç”¨ $ReLU$ çš„ç¥ç»å…ƒåªéœ€è¦è¿›è¡ŒåŠ ã€ä¹˜å’Œæ¯”è¾ƒçš„æ“ä½œï¼Œè®¡ç®—ä¸Šæ›´åŠ é«˜æ•ˆï¼`Sigmoid` å‹æ¿€æ´»å‡½æ•°ä¼šå¯¼è‡´ä¸€ä¸ªéç¨€ç–çš„ç¥ç»ç½‘ç»œï¼Œè€Œ $ReLU$
å´å…·æœ‰å¾ˆå¥½çš„ç¨€ç–æ€§ï¼Œå¤§çº¦ 50% çš„ç¥ç»å…ƒä¼šå¤„äºæ¿€æ´»çŠ¶æ€ï¼

åœ¨ä¼˜åŒ–æ–¹é¢ï¼Œç›¸æ¯”äº `Sigmoid`å‹å‡½æ•°çš„ä¸¤ç«¯é¥±å’Œï¼Œ`ReLU` å‡½æ•°ä¸ºå·¦é¥±å’Œå‡½æ•°ï¼Œ ä¸”åœ¨ ğ‘¥ > 0 æ—¶å¯¼æ•°ä¸º
1ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†ç¥ç»ç½‘ç»œçš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼ŒåŠ é€Ÿæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦ï¼

### ç¼ºç‚¹

$ReLU$ å‡½æ•°çš„è¾“å‡ºæ˜¯éé›¶ä¸­å¿ƒåŒ–çš„ï¼Œç»™åä¸€å±‚çš„ç¥ç»ç½‘ç»œå¼•å…¥åç½®åç§»ï¼Œ ä¼šå½±å“æ¢¯åº¦ä¸‹é™çš„æ•ˆç‡ï¼æ­¤å¤–ï¼ŒReLU ç¥ç»å…ƒåœ¨è®­ç»ƒæ—¶æ¯”è¾ƒå®¹æ˜“â€œæ­»äº¡â€ï¼åœ¨è®­
ç»ƒæ—¶ï¼Œå¦‚æœå‚æ•°åœ¨ä¸€æ¬¡ä¸æ°å½“çš„æ›´æ–°åï¼Œç¬¬ä¸€ä¸ªéšè—å±‚ä¸­çš„æŸä¸ª ReLU ç¥ç»å…ƒåœ¨ æ‰€æœ‰çš„è®­ç»ƒæ•°æ®ä¸Šéƒ½ä¸èƒ½è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆè¿™ä¸ªç¥ç»å…ƒè‡ªèº«å‚æ•°çš„æ¢¯åº¦æ°¸è¿œéƒ½ä¼šæ˜¯
0ï¼Œåœ¨ä»¥åçš„è®­ç»ƒè¿‡ç¨‹ä¸­æ°¸è¿œä¸èƒ½è¢«æ¿€æ´»(åœ¨ä¸Šä¸€å±‚ç¥ç»ç½‘ç»œä¸­å·²ç»è¢«æ»¤æ‰äº†,æ‰€ä»¥ä»¥åå°±ä¸ä¼šå†æœ‰äº†,
é—®é¢˜åœ¨äºä½ æ ¹æœ¬ä¸çŸ¥é“ä»¥åä¼šä¸ä¼šç”¨åˆ°è¿™äº›ç¥ç»å…ƒä¸­çš„ä¿¡æ¯)ï¼è¿™ç§ç°è±¡ç§°ä¸ºæ­»äº¡ $ReLU$ é—®é¢˜ï¼ˆDying ReLU Problemï¼‰ï¼Œå¹¶ä¸”ä¹Ÿæœ‰å¯èƒ½ä¼šå‘ç”Ÿåœ¨å…¶ä»–éšè—å±‚ï¼

### Leaky ReLU

ä¸ºäº†é˜²æ­¢ç¥ç»å…ƒç§ç½‘çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº† LeakyRelu å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä¸»è¦ç›®çš„æ˜¯ï¼Œåœ¨ x å°äº 0
çš„æ—¶å€™ï¼Œç»™ä»–ä¸€ä¸ªå¾ˆå°çš„ç³»æ•°ï¼Œè®©è¯¥ç¥ç»å…ƒçš„å½±å“å°½å¯èƒ½çš„å°ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†ä»–è¿‡æ»¤æ‰ã€‚

$$
\begin{aligned}
LeakyReLU(ğ‘¥) & = \left \lbrace
\begin{align}
x &\qquad x \gt 0; \\\\
\gamma x & \qquad x \le 0
\end{align}
\right . \\\\
& = \max(x, \gamma x),
\end{aligned}
\tag{5.2}
$$

### Parametric ReLU

å¸¦å‚æ•°çš„ ReLUï¼ˆParametric ReLUï¼ŒPReLUï¼‰å¼•å…¥ä¸€ä¸ªå¯å­¦ä¹ çš„å‚æ•°ï¼Œä¸åŒç¥ç»å…ƒå¯ä»¥æœ‰ä¸åŒçš„å‚æ•°ï¼å¯¹äºç¬¬ i ä¸ªç¥ç»å…ƒï¼Œå…¶ PReLU çš„
å®šä¹‰ä¸º:

$$
\begin{aligned}
ParametricReLU(ğ‘¥) & = \left \lbrace
\begin{align}
x &\qquad x \gt 0; \\\\
\gamma_i x & \qquad x \le 0
\end{align}
\right . \\\\
& = \max(x, \gamma_i x),
\end{aligned}
\tag{5.3}
$$

å¦‚æœ$ ğ›¾_ğ‘–= 0$ï¼Œé‚£ä¹ˆ PReLU å°±é€€åŒ–ä¸º ReLUï¼å¦‚æœ$ ğ›¾_ğ‘– $ä¸ºä¸€ä¸ªå¾ˆå°çš„å¸¸æ•°ï¼Œåˆ™ PReLU å¯ä»¥çœ‹ä½œå¸¦æ³„éœ²çš„ ReLUï¼PReLU
å¯ä»¥å…è®¸ä¸åŒç¥ç»å…ƒå…·æœ‰ä¸åŒçš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¸€ç»„ç¥ç»å…ƒå…±äº«ä¸€ ä¸ªå‚æ•°ï¼

![ReLUå’ŒLeaky Relu](/assets/images/image-20200416162450890.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_relu = np.array([max(0, x) for x in X])
y_leaky_relu = np.array([max(0, x) + 0.2 * min(0, x) for x in X])
# ä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿå…¶ä¸­ lambda çš„å€¼è®¾å®šä¸º0.2
plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -1.1, 1.1, colors = "gray", linestyles = "dashed")
plt.plot(X, y_relu,label="ReLU", color='red')
plt.plot(X, y_leaky_relu, label="Leaky ReLU", color='green', linestyle='dashed' )
plt.legend(loc='best')
```

## ELU å‡½æ•°

ELUï¼ˆ`Exponential Linear Unit`ï¼ŒæŒ‡æ•°çº¿æ€§å•å…ƒï¼‰[Clevert et al., 2015] æ˜¯ä¸€ä¸ªè¿‘ä¼¼çš„é›¶ä¸­å¿ƒåŒ–çš„éçº¿æ€§å‡½æ•°ï¼Œå…¶å®šä¹‰ä¸º

$$
\begin{aligned}
ELU(ğ‘¥) & = \left \lbrace
\begin{align}
x &\qquad x \gt 0; \\\\
\gamma_i (e^x - 1) & \qquad x \le 0
\end{align}
\right . \\\\
& = \max(x, \gamma_i  (e^x - 1)),
\end{aligned}
\tag{6}
$$

å…¶ä¸­$ ğ›¾ â‰¥ 0$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œå†³å®š $ğ‘¥ â‰¤ 0 $æ—¶çš„é¥±å’Œæ›²çº¿ï¼Œå¹¶è°ƒæ•´è¾“å‡ºå‡å€¼åœ¨$ 0$ é™„è¿‘ï¼

![Leaky ReLU å’Œ ELU](/assets/images/image-20200416163052410.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_leaky_relu = np.array([max(0, x) + 0.2 * min(0, x) for x in X]) # ä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿå…¶ä¸­ lambda çš„å€¼è®¾å®šä¸º0.2
y_elu = np.array([max(0, x) + 0.2 * min(0, np.e ** x - 1) for x in X]) # ä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿå…¶ä¸­ lambda çš„å€¼è®¾å®šä¸º0.2
plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -1.1, 1.1, colors = "gray", linestyles = "dashed")
plt.plot(X, y_leaky_relu, label="Leaky ReLU", color='red')
plt.plot(X, y_elu, label="ELU", color='green')
plt.legend(loc='best')
```

## SoftPlus å‡½æ•°

`Softplus` å‡½æ•°å¯ä»¥çœ‹ä½œ `Rectifier` å‡½æ•°(`ReLU`å‡½æ•°)çš„å¹³æ»‘ç‰ˆæœ¬ï¼Œå…¶å®šä¹‰ä¸ºï¼š

$$
Softplus(ğ‘¥) = \log(1 + e^x) \tag{7}
$$

`Softplus`å‡½æ•°å…¶å¯¼æ•°åˆšå¥½æ˜¯ `Logistic` å‡½æ•°ï¼`Softplus` å‡½æ•°è™½ç„¶ä¹Ÿå…·æœ‰å•ä¾§æŠ‘åˆ¶ã€å®½å…´å¥‹è¾¹ç•Œçš„ç‰¹æ€§ï¼Œå´æ²¡æœ‰ç¨€ç–æ¿€æ´»æ€§ï¼

![ReLUå‡½æ•°å’ŒSoftPluså‡½æ•°](/assets/images/image-20200416163553648.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_relu = np.array([max(0, x) for x in X])
y_softplus = np.log(1 + np.exp(X))
plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -2, 2, colors = "gray", linestyles = "dashed")
plt.plot(X, y_relu,label="ReLU", color='red')
plt.plot(X, y_softplus, label="Soft Plus", color='green', linestyle='dashed' )
plt.legend(loc='best')
```

## Swish å‡½æ•°

`Swish` å‡½æ•°æ˜¯ä¸€ç§è‡ªé—¨æ§ï¼ˆSelf-Gatedï¼‰æ¿€æ´»å‡½æ•°ï¼Œå®šä¹‰ä¸º:

$$
swish(x) = x ğœ (\beta x) \tag{8}
$$

å…¶ä¸­$ğœ(â‹…)$ ä¸º `Logistic` å‡½æ•°ï¼Œ$ğ›½$ ä¸ºå¯å­¦ä¹ çš„å‚æ•°æˆ–ä¸€ä¸ªå›ºå®šè¶…å‚æ•°ï¼$ğœ(â‹…) âˆˆ (0, 1)$ å¯ ä»¥çœ‹ä½œä¸€ç§è½¯æ€§çš„é—¨æ§æœºåˆ¶ï¼å½“ $ğœ(ğ›½ğ‘¥)$
æ¥è¿‘äº 1 æ—¶ï¼Œé—¨å¤„äºâ€œå¼€â€çŠ¶æ€ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å‡ºè¿‘ä¼¼äº $ğ‘¥$ æœ¬èº«ï¼›å½“$ ğœ(ğ›½ğ‘¥)$ æ¥è¿‘äº 0 æ—¶ï¼Œé—¨çš„çŠ¶æ€ä¸ºâ€œå…³â€ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å‡ºè¿‘ä¼¼äº $0$ï¼

![Swish](/assets/images/image-20200416174418547.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ

plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -3, 3, colors = "gray", linestyles = "dashed")

beta = [0, 0.5, 1, 10, 100]
color = ['darkgreen','darkkhaki','darkmagenta'
         ,'darkolivegreen','darkorange','darkorchid','darkred']
plt.plot(X, X, color="gray", label="y=x", linestyle = "dashed")
for i in range(len(beta)):
    y = X * (1 / (1 + np.exp(- beta[i] * X)))
    plt.plot(X, y, color=color[i], label="Swish(beta = %s)" % beta[i])
plt.legend(loc='best')
```

å½“$ ğ›½ = 0 $æ—¶ï¼ŒSwish å‡½æ•°å˜æˆçº¿æ€§å‡½æ•° $\frac{x}{2}$ ï¼å½“ $ğ›½ = 1$ æ—¶ï¼ŒSwish å‡½æ•°åœ¨ $ğ‘¥ > 0$ æ—¶è¿‘ä¼¼çº¿æ€§ï¼Œåœ¨ $ğ‘¥ < 0$
æ—¶è¿‘ä¼¼é¥±å’Œï¼ŒåŒæ—¶å…·æœ‰ä¸€å®šçš„éå•è°ƒæ€§ï¼å½“ $ğ›½ â†’ +âˆ\infty$ æ—¶ï¼Œ$ğœ(ğ›½ğ‘¥)$ è¶‹å‘äºç¦»æ•£çš„ $0-1$ å‡½æ•°ï¼Œ`Swish` å‡½æ•°è¿‘ä¼¼ä¸º `ReLU`
å‡½æ•°ï¼å› æ­¤ï¼Œ`Swish` å‡½æ•°å¯ä»¥çœ‹ä½œçº¿æ€§å‡½æ•°å’Œ ReLU å‡½æ•°ä¹‹é—´çš„éçº¿æ€§æ’å€¼å‡½æ•°ï¼Œå…¶ç¨‹åº¦ç”±å‚æ•° ğ›½ æ§åˆ¶ï¼

## GELU å‡½æ•°

GELUï¼ˆGaussian Error Linear Unitï¼Œé«˜æ–¯è¯¯å·®çº¿æ€§å•å…ƒï¼‰ä¹Ÿæ˜¯ä¸€ç§é€šè¿‡é—¨æ§æœºåˆ¶æ¥è°ƒæ•´å…¶è¾“å‡ºå€¼çš„æ¿€æ´»å‡½æ•°ï¼Œå’Œ Swish å‡½æ•°æ¯”è¾ƒ ç±»ä¼¼ï¼

$$
GELU(ğ‘¥) = ğ‘¥ğ‘ƒ(ğ‘‹ â‰¤ ğ‘¥) \tag{9.1}
$$

å…¶ä¸­ $ğ‘ƒ(ğ‘‹ â‰¤ ğ‘¥)$ æ˜¯é«˜æ–¯åˆ†å¸ƒ $ğ’©(ğœ‡, ğœ^2 )$ çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼Œå…¶ä¸­ $ğœ‡, ğœ$ ä¸ºè¶…å‚æ•°ï¼Œä¸€èˆ¬è®¾ $ğœ‡ = 0, ğœ = 1$ å³å¯ï¼ç”±äºé«˜æ–¯åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ä¸º
S å‹å‡½æ•°ï¼Œå› æ­¤ GELU å‡½æ•°å¯ä»¥ç”¨ Tanh å‡½æ•°æˆ– Logistic å‡½æ•°æ¥è¿‘ä¼¼ï¼Œ

$$
GELU(ğ‘¥) â‰ˆ 0.5ğ‘¥ \left ( 1 + \tanh \left ( \sqrt{\frac{2}{\pi}} \left ( x + 0.044715 x ^ 3 \right ) \right ) \right )
\tag{9.2}
$$

æˆ–

$$
GELU(ğ‘¥) â‰ˆ ğ‘¥ğœ(1.702ğ‘¥) \tag{9.3}
$$

å½“ä½¿ç”¨ Logistic å‡½æ•°æ¥è¿‘ä¼¼æ—¶ï¼ŒGELU ç›¸å½“äºä¸€ç§ç‰¹æ®Šçš„ Swish å‡½æ•°ï¼

![ReLUå’ŒGELU](/assets/images/image-20200416175637804.webp)

```python
X = np.linspace(-3,3,2000) # X ä¸ºå›¾åƒçš„å®šä¹‰åŸŸ
y_relu = np.array([max(0, x) for x in X])
y_softplus = np.log(1 + np.exp(X))
plt.figure(figsize=(20,10))
plt.hlines(0, -3., 3, colors = "gray", linestyles = "dashed")
plt.vlines(0, -2, 2, colors = "gray", linestyles = "dashed")
plt.plot(X, y_relu,label="ReLU", color='red')
y = X * (1 / (1 + np.exp(- 1.702 * X)))
plt.plot(X, y, color=color[3], label="GELU")
plt.legend(loc='best')
```
